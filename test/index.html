<!DOCTYPE html>
<html>
  <head>
    <title>Express</title>
    <style>
    div{
      height: 150px;
      width: 700px;
      border-width: thin;
      border-style: solid;
      border-color: #ff0000;
    }
    </style>
  </head>
  <body>
    <h1>File Server API</h1>
    <p>Welcome to Test</p>

    <h2>Upload a file</h2>
    <form action="http://localhost:8081/" method="post" enctype="multipart/form-data" target="upload">
      <input type="file" name="file" multiple="multiple"><br>
      <input type="submit" value="submit">
    </form>
    <iframe id="upload" name="upload" width="700" height="100"></iframe>

    <h2>Get file infomation</h2>
    <label>file-token</label>
    <input type="text" id="infoHash" value="">
    <button onclick="getFileInfo()">submit</button>
    <div id="info"></div>

    <h2>download file</h2>
    <label>file-token</label>
    <input type="text" id="downHash" value="">
    <button onclick="getFileUrl()">submit</button>
    <div id="down"></div>

    <h2>download resize file</h2>
    <label>mode</label>
    <input type="text" id="mode" value="">
    <label>width</label>
    <input type="text" id="width" value="">
    <label>height</label>
    <input type="text" id="height" value="">
    <label>picToken</label>
    <input type="text" id="picHash" value="">
    <button onclick="getResizePic()">submit</button>
    <div id="pic"></div>

    <h2>delete file</h2>
    <label>file-token</label>
    <input type="text" id="deleHash" value="">
    <button onclick="deleteFile()">submit</button>
    <div id="delete"></div>

    <script>
    function loadXMLDoc(method, action, headers, result){
      var xmlhttp;
      if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
      } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=function(){
        document.getElementById(result).innerText = xmlhttp.responseText;
      }
      xmlhttp.open(method, action, true);
      for (var key in headers) {
        if (headers.hasOwnProperty(key)) {
          xmlhttp.setRequestHeader(key, headers[key]);
        }
      }
      xmlhttp.send();
    }

    function getFileInfo() {
      loadXMLDoc('GET', 'http://localhost:8081/info/' + document.getElementById('infoHash').value, null, 'info');
    }

    function getFileUrl() {
      loadXMLDoc('GET', 'http://localhost:8081/' + document.getElementById('downHash').value, null, 'down')
    }

    function getResizePic() {
      var headers = { mode:document.getElementById('mode').value, width:document.getElementById('width').value, height:document.getElementById('height').value}
      loadXMLDoc('GET', 'http://localhost:8081/' + document.getElementById('picHash').value, headers, 'pic')
    }

    function deleteFile() {
      loadXMLDoc('DELETE', 'http://localhost:8081/' + document.getElementById('deleHash').value, null, 'delete')
    }
    </script>

  </body>
</html>
